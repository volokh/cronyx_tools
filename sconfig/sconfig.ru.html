<HTML><HEAD><meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Language" content="ru">
<TITLE>Страница руководства Кроникс</TITLE></HEAD><BODY><H1>sconfig</H1>
<A NAME="lbAB">&nbsp;</A>
<H2>ИМЯ</H2>

sconfig - утилита управления для адаптеров Кроникс (версия 6.1)
<A NAME="lbAC">&nbsp;</A>
<H2>ОБЗОР</H2>

<B>sconfig</B>

[<B>-raimsxeftucqv</B>]

[<B>имя объекта </B>[<B>параметры...</B>]]

<P>
Эта утилита предназначена для конфигурирования и управления адаптерами
производства &quot;КБ Кроникс&quot;. За более детальной информацией обращайтесь к файлам <I>readme.txt</I>.
<A NAME="lbAD">&nbsp;</A>
<H2>ОПИСАНИЕ</H2>

Комплект драйверов состоит из исходных текстов модулей ядра ОС Linux и
утилиты управления <B>sconfig</B>.
Всё взаимодействие пользователя
(системного администратора) с комплектом драйверов производится с
помощью утилиты <B>sconfig</B>.
Дополнительно для удобства использования в
наиболее распространённых конфигурациях предусмотрен единый
конфигурационный файл
<I>/etc/cronyx.conf</I>

и обрабатывающий его sh-сценарий, который может быть установлен в
<I>/etc/rc.d</I>

или
<I>/etc/init.d</I>

подсистему.
<P>
В комплект драйверов входит несколько &quot;протокольных модулей&quot;, которые
организуют взаимодействие между низкоуровневыми драйверами адаптеров и
остальными компонентами системы. Привязка &quot;протокольных модулей&quot; к
низкоуровневым драйверам, а также предоставление интерфейса для
централизованного управления входит в задачи связующего модуля <B>binder</B>.
<P>
Управление комплектом драйверов сводится к загрузке необходимых
модулей ядра, установке требуемых параметров (для линейных
интерфейсов, логических каналов приёма-передачи и адаптеров в целом)
и далее к назначению канальных протоколов, настройке полученных
сетевых интерфейсов.
<P>
Протокольные модули с сетевой поддержкой создают в системе стандартные
сетевые интерфейсы, настройка и взаимодействие с которыми, происходит
стандартным способом (с помошью
<B><A HREF="/cgi-bin/man/man2html?8+ifconfig">ifconfig</A></B>(8)

и других системных утилит).
В асинхронном режиме все параметры должны быть установлены при помощи
системной утилиты
<B><A HREF="/cgi-bin/man/man2html?1+stty">stty</A></B>(1),

<B>sconfig</B> позволит вам управлять лишь некоторыми из них.
<P>
Некоторые установки могут быть сделаны только на свободных каналах,
кода соответствующие сетевые интерфейсы отключены
(находятся в состоянии <B>down</B>),
терминальные устройства
<I>/dev/tty*</I>

или файловые дескрипторы devnode закрыты.
Другие установки могут быть сделаны `на ходу'.
Как правило, большинство параметров настраивается во время загрузки операционной системы.
Например, посредством вызовов
<B>sconfig</B>

из файла <I>/etc/rc</I>.
<P>
ЗАМЕЧАНИЕ: Не все параметры могут быть использованы в конкретном случае,
попытка установить некоторые из них может привести к разрыву связи по отдельному каналу или адаптеру в целом.

<A NAME="lbAE">&nbsp;</A>
<H2>ОПЦИИ</H2>

Вы можете указать только одну из перечисленных ниже опций. Если задана какая-нибудь опция, отвечающая за вывод информации,
<B>sconfig</B>

отобразит соответствующую информацию и проигнорирует остальные,
за исключением <B>&lt;имени объекта&gt;</B>, т.е. имени канала, интерфейса или адаптера.
Смотрите также описание параметра <B>&lt;имя объекта&gt;</B>.
<P>
Если <B>&lt;имени объекта&gt;</B> не задано, то соответствующее действие выполняется для всех
существующих объектов.
<DL COMPACT>
<DT>&lt;пусто&gt;<DD>
Просмотр текущих установок для объекта.
<DT>-r<DD>
Отображение карты существующих объектов.
<DT>-a<DD>
Вывод полной информации о конфигурации объекта.
<DT>-i<DD>
вывод статистики сетевого интерфейса, аналогично команде
<B><A HREF="/cgi-bin/man/man2html?1+ifconfig">ifconfig</A></B>(1).

<DT>-m<DD>
Вывод информации о состоянии модемных сигналов. Описание всех модемных сигналов может быть найдено в любой документации по такому оборудованию. Только сигнал
<B>LE</B>

(происходит от признака `Link Enabled' в BSD-системах) должен быть описан отдельно. Если этот сигнал активен (On), значит канал используется. Если он выключен (Off), значит канал свободен.
<DT>-s<DD>
Вывод краткой статистики логического канала.
Эта информация может быть полезна, если что-то не работает. Например, если непоступают прерывания от ISA-адаптера, то (возможно) выбранное IRQ не зарезервировано в BIOS за шиной ISA.
<DT>-x<DD>
Вывод подробной статистики логического канала. Эта опция позволяет просмотреть большее количество различных счетчиков, но в более сжатом формате чем по опции <B>-s</B>.
<DT>-e<DD>
Вывод краткой статистики интерфейса E1/G.703. Будет отображена информация собранная за последний неполный 15-минутный интервал. Описание формата смотрите ниже.
<DT>-f<DD>
Вывод полной статистики интерфейса E1/G.703. Будет отображена вся информация, выдаваемая по опции <B>-e</B>, и вся статистика за последние 24 часа (если доступно). Описание формата смотрите ниже.
<DT>-t<DD>
Вывод краткой статистики интерфейса E3/T3/STS-1. Будет отображена информация собранная за последний 15-минутный интервал. Описание формата смотрите ниже.
<DT>-u<DD>
Вывод полной статистики интерфейса E3/T3/STS-1. Будет отображена вся информация, выдаваемая по опции <B>-t</B>, и вся статистика за последние 24 часа (если доступно). Описание формата смотрите ниже.
<DT>-c<DD>
Очистка статистики.
<DT>-q<DD>
Не выводить никакой информации.
<DT>-v<DD>
Вывод информации о версии.

</DL>
<A NAME="lbAF">&nbsp;</A>
<H2>ИМЯ ОБЪЕКТА</H2>

<DL COMPACT>
<DT><B>Важное историческое замечание:</B>

<DD>
До версии комплекта 6.0 использовалась старая &quot;плоская&quot; система
именования, при которой имена назначались только каналам
приёма-передачи данных. Такая схема была удобной и достаточной, пока
каждый логический канал однозначно соответствовал аппаратному
линейному интерфейсу.
<P>
С появлением нового поколения адаптеров (Tau-PCI/2E1, Tau-PCI/4E1 и
Tau-PCI/32) стала возникать путаница, так как логические каналы больше
не соответствовали линейным интерфейсам, а при конфигурировании
линейных интерфейсов возникала нелогичность и неоднозначность в их
выборе.
<P>
Поэтому начиная с версии 6.0 была введена новая &quot;иерархическая&quot;
система именования. Новая схема именует и различает объекты нескольких
типов: <B>`адаптер'</B>, <B>`интерфейс'</B>, <B>`канал'</B>. При этом, каждый из объектов
имеет свой набор конфигурационных параметров. Соответственно для
задания полной конфигурации необходимо отдельно определить набор
параметров для каждого из объектов. При этом необходимо произвести
большее количество действий, но зато всегда есть полная ясность и
однозначность.
</DL>
<P>

<P>
Адаптерам присваиваются имена вида <B>&lt;тип-адаптера_#&gt;</B>, например:
`tau32_0', `taupci_0', `tauisa_2' и т.д.
<P>
Линейным интерфейсам (E1, V.35, RS-530 и т.д.) присваиваются имена
вида <B>&lt;имя-адаптера.тип-интерфейса_#&gt;</B>. Где `имя-адаптера'
соответствует адаптеру, на котором расположен линейный интерфейс. А
`тип-интерфейса_#' определяет тип и порядковый номер интерфейса на
адаптере. Например: `tau32_0.e1_0', `taupci_0.e1_3', `tauisa_0.s_1' и
т.д.
<P>
Тип линейного интерфейса именуется так:
<DL COMPACT>
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;`s'</B></FONT>
<DD>
синхронный последовательный интерфейс;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;`e1'</B></FONT>
<DD>
интерфейс E1/ИКМ-30 (ITU-T G.703) c поддержкой структурированного режима ITU-T G.704;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;`g703'</B></FONT>
<DD>
интерфейс ITU-T G.703 с поддержкой только неструктурированного режима;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;`e3'</B></FONT>
<DD>
интерфейс E3;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;`rs232'</B></FONT>
<DD>
синхронный последовательный RS-232;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;`rs449'</B></FONT>
<DD>
синхронный последовательный RS-449;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;`rs530'</B></FONT>
<DD>
синхронный последовательный RS-530;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;`v35'</B></FONT>
<DD>
синхронный последовательный V.35;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;`x21'</B></FONT>
<DD>
синхронный последовательный X.21;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;`a'</B></FONT>
<DD>
асинхронный последовательный интерфейс RS-232;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;`u'</B></FONT>
<DD>
универсальный синхронный/асинхронный интерфейс;
</DL>
<P>

Логические каналы приёма/передачи данных получают имена вида
<B>&lt;имя-адаптера.#&gt;</B>, где указывается имя адаптера, на котором расположен
логический канал, и номер канала на адаптере. Например: `tau32_0.0',
`tau32_0.31', `taupci_1.3' и т.д.
<P>
Кроме этого, для удобства логическим каналам присваиваются псевдонимы
(aliases), которые совпадают с их именами в старой схеме именования.
Это позволяет использовать более короткие имена (в том числе
получаемых сетевых интерфейсов) и одновременно сохранить максимум
совместимости с прикладным ПО рассчитанным на старую схему именования.
Псевдонимы логических каналов имеют вид <B>ce#</B>, <B>cp#</B>, <B>ct#</B> и <B>cx#</B>
для адаптеров Tau-PCI/32, Tau-PCI, Tau-ISA и Sigma-ISA соответственно.
<P>
Посмотреть актуальный список доступных объектов можно по команде

<I>sconfig&nbsp;-r</I>.

Псевдонимы логических каналов отображаются через `/'
(слеш) после имени.
<P>
Для просмотра текущей конфигурации необходимо вызвать утилиту
<B>sconfig</B>

с именем интересующего объекта. При вызове без параметров
<B>sconfig</B>

отобразит основные параметры конфигурации для всех доступных объектов.
<P>
Для изменения конфигурации утилите
<B>sconfig</B>

кроме имени объекта
необходимо указать имена изменяемых параметров конфигурации и их
значения в форме <B>&lt;параметр=значение&gt;</B>.
<P>
Для адаптеров, интерфейсов и каналов доступны разные наборы
параметров. В каждом конкретном случае множество доступных параметров
зависит от модели адаптера, типа интерфейса, режима работы и
выбранного протокола. Например, параметр `line=' (кодирование в линии)
недоступен для асинхронных интерфейсов, а параметр `dpll=' (включение
DPLL/ФАПЧ) недоступен для интерфейсов E1. Для просмотра всех
параметров применимых к объекту вызовите
<B>sconfig</B>

c опцией
<B>-a</B>

и указанием имени объекта.
<P>

<A NAME="lbAG">&nbsp;</A>
<H2>КОНФИГУРИРОВАНИЕ АДАПТЕРОВ</H2>

<DL COMPACT>
<DT><B>adapter=..</B>

<DD>
Задаёт режим работы для адаптеров Tau-ISA и
Tau-PCI с интерфейсами E1. Возможные значения:
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;separate</B></FONT>
<DD>
режим независимых каналов. Каждому линейному
интерфейсу соответствует один логический канал;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;mux</B></FONT>
<DD>
режим мультиплексирования канальных интервалов
между линейными интерфейсами и логическими
каналами;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;split</B></FONT>
<DD>
распределение канальных интервалов интерфейса E1
между логическими каналами приёма-передачи;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;b-mode</B></FONT>
<DD>
режим &quot;B&quot; адаптера Tau-ISA/E1;
<DT><B>led=..</B>

<DD>
Задаёт режим индикации светодиодом адаптера различных
ситуаций и событий. Допустимы комбинации следующих
опций, которые перечисляются без пробелов через запятую:
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;smart</B></FONT>
<DD>
режим по умолчанию, индикатор моргает в зависимости
от состояния физического интерфейса (шлейф, потеря
несущей, потеря фреймовой синхронизации т.д.);
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;on</B></FONT>
<DD>
индикатор постоянно горит;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;off</B></FONT>
<DD>
индикатор погашен;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;#(number)</B></FONT>
<DD>
32-битное значение позволяет задать произвольный
режим каденции;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;irq</B></FONT>
<DD>
если указано, индикатор кратковременно вспыхивает
(либо гаснет в комбинации с <B>on</B>) при каждом аппаратном прерывании
со стороны адаптера;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;rx</B></FONT>
<DD>
если указано, индикатор кратковременно вспыхивает
(либо гаснет в комбинации с <B>on</B>) при приёме пакета (порции) данных;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;tx</B></FONT>
<DD>
если указано, индикатор кратковременно вспыхивает
(либо гаснет в комбинации с <B>on</B>) при передаче пакета (порции) данных;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;err</B></FONT>
<DD>
если указано, индикатор кратковременно вспыхивает
(либо гаснет в комбинации с <B>on</B>) при ошибках приёма-передачи;
<DT><B>subchan=..</B>

<DD>
задаёт множество канальных интервалов для режима
&quot;B&quot; адаптера Tau-ISA/E1. Например: subchan=16,29-31.
<DT><B>reset</B>

<DD>
Сброс/перезапуск адаптера, по-возможности с полным сбросом аппаратной части.

</DL>
<A NAME="lbAH">&nbsp;</A>
<H2>КОНФИГУРИРОВАНИЕ ЛОГИЧЕСКИХ КАНАЛОВ</H2>

<DL COMPACT>
<DT><B>debug=#</B>

<DD>
Задаёт уровень (0..2) выдачи отладочной информации, &quot;0&quot; - отладка выключена, &quot;2&quot; - максимум отладочной информации (для разработчиков);
<DT><B>extclock</B>

<DD>
Включает режим внешней синхронизации для последовательных синхронных интерфейсов (V.35, RS-530 и т.д.).
Режим внешней синхронизации является основным при подключении к модемному оборудованию (устройству DCE). В этом режиме внешний сигнал синхронизации поступает на контакт разъёма TXCIN и используется как тактирующий синхросигнал для передачи данных (контакт разъёма TXD);
<DT><B>#(number)</B>

<DD>
Для серийных синхронных интерфейсов (V.35, RS-530 и т.д.), задаёт скорость в битах в секунду и включает синхронизацию от внутреннего генератора адаптера.
Нулевое значение будет эквивалентно указанию опции
<B>extclock</B>. В случае ненулевого значения скорость обмена будет установлена равной заданному значению в бит/с. При этом, в качестве источника синхросигнала будет использоваться внутренний генератора адаптера.
Передаваемые данные будут синхронизированы с сигналом внутреннего генератора адаптера, сгенерированный синхросигнал будет подаваться на контакт TXCOUT, а сигнал с контакта разъёма TXCIN будет игнорирован.
Этот режим используется для непосредственного соединения адаптера с терминальным оборудованием (устройством DTE). Также режим внутренней синхронизации необходим
для тестирования с использованием внешнего замыкателя;
<DT><B>mtu=#</B>

<DD>
Задаёт ограничение размера MTU (Maximum Transfer Unit);
<DT><B>qlen=#</B>

<DD>
Задаёт длину очередей приёма-передачи. Необходимо правильно задавать размер очередей, находя компромисс между вынужденной задержкой данных и вероятностью ситуаций underrun/overrun вследствие латентности системы при обработке аппаратных прерываний;
<DT><B>timeslots=.. или ts=..</B>

<DD>
Задаёт список канальных интервалов для интерфейсов E1/ИКМ-30. Например: &quot;ts=1-7,15,27-29&quot;;
<DT><B>iface=#</B>

<DD>
Привязывает логический канал приёма-передачи к линейному интерфейсу по его порядковому номеру на адаптере (0, 1, 2, 3...);
<DT><B>mode=..</B>

<DD>
Задаёт режим работы логического канала. Возможные значения:
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;async</B></FONT>
<DD>
асинхронный режим (только для Sigma-ISA);
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;hdlc</B></FONT>
<DD>
синхронный режим, приём-передача пакетов в формате HDLC Layer 2;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;phony</B></FONT>
<DD>
для адаптеров Tau-PCI/32 и Tau-PCI cинтерфейсами E1/ИКМ-30, непосредственный обмен данными (&quot;телефонный&quot; режим);
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;voice</B></FONT>
<DD>
аналогичен режиму &quot;phony&quot;, но оптимизирован для &quot;телефонных&quot; применений. Отличия между режимами &quot;phony&quot; и &quot;voice&quot; в поведении при ситуации transmit-underrun:
</DL>
<P>

* в режиме &quot;voice&quot; на передачу подставляется порция данных заполненная кодом 0xD5 а в режиме &quot;phony&quot; кодом 0xFF;
<P>

* в режиме &quot;voice&quot; очередная порция помещается в уже передаваемый подставленный буфер, а в режиме &quot;phony&quot; в следующий;
<P>

Поэтому режим &quot;voice&quot; оптимален для &quot;голосовых&quot; применений, в частности для DAHDI/Zaptel, при этом последствия ситуаций underrun менее заметны.
<P>

Режим &quot;phony&quot; нужен для корректной работы в случаях когда ситуация underrun не является ошибкой, например при работе пакетных протоколов с байт-стаффингом;
<P>

<DL COMPACT>
<DT><B>crc=..</B>

<DD>
задает режим формирования и контроля FCS (CRC) для HDLC. Возможные значения:
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;none</B></FONT>
<DD>
генерация и контроль CRC отключены (0 байт FCS), только для Tau-PCI/32;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;16</B></FONT>
<DD>
используется 16-битный (2 байта FCS) контроль по ITU-T Q.921;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;32</B></FONT>
<DD>
используется 32-битный (4 байта FCS) контроль, только для Tau-PCI/32;

</DL>
<A NAME="lbAI">&nbsp;</A>
<H2>КОНФИГУРИРОВАНИЕ ПРОТОКОЛЬНЫХ МОДУЛЕЙ</H2>

<DL COMPACT>
<DT><B>dlci=#</B>

<DD>
При использовании протокольного модуля Frame Relay добавляет PVC (Permanent Virtual Circuit) с указанным номером DLCI;
<DT><B>qlen-limit=#</B>

<DD>
При использовании DAHDI/zaptel-протоколов задает предел для автоматического увеличения длины очередей
приёма/передачи в результате обнаружения ситуаций переполнения/опустошения;
<DT><B>ec-delay=#</B>

<DD>
При использовании DAHDI/zaptel-протоколов задает задержку в миллисекундах (с точностью до 0.125 мс) в подаче
переданного в линию E1/ИКМ-30 сигнала на вход обратной связи эхоподавителя. Допускается указание ec-delay=auto,
в результате будет установлено адекватное значение исходя из текущего значения параметра qlen.
Например: &quot;ec-delay=3.125&quot; или &quot;ec-delay=auto&quot;;

</DL>
<A NAME="lbAJ">&nbsp;</A>
<H2>КОНФИГУРИРОВАНИЕ ЛИНЕЙНЫХ ИНТЕРФЕЙСОВ</H2>

<DL COMPACT>
<DT><B>loop=..</B>

<DD>
включает/выключает шлейф (заворот данных). Возможные значения:
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;off</B></FONT>
<DD>
нормальный режим, все шлейфы выключены;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;internal</B></FONT>
<DD>
внутренний шлейф - данные, передаваемые в линию, принимаются обратно;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;mirror</B></FONT>
<DD>
внешний шлейф - данные, принимаемые из линии, передаются (отражаются) обратно в линию;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;remote</B></FONT>
<DD>
выдача запроса на удалённую сторону на включение заворота данных, принимаемых с нашей стороны;
<DT><B>dpll=on/off</B>

<DD>
Включение ФАПЧ (DPLL) на последовательных синхронных интерфейсах для восстановления тактирующего синхросигнала по поступающим данным;
<DT><B>line=..</B>

<DD>
Выбор линейного кода. Возможные варианты зависят от вида линейного интерфейса:
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;nrz</B></FONT>
<DD>
код NRZ, для последовательных синхронных интерфейсов;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;nrzi</B></FONT>
<DD>
код NRZI, для последовательных синхронных интерфейсов;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;hdb3</B></FONT>
<DD>
код HDB3, для интерфейсов E1/ИКМ-30 и G.703;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;ami</B></FONT>
<DD>
код AMI, для интерфейсов E1/ИКМ-30 и G.703;
<DT><B>invclk=..</B>

<DD>
Для последовательных синхронных интерфейсов, режим инверсии тактирующих синхросигналов. Возможные значения:
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;normal/off</B></FONT>
<DD>
нормальный режим (по умолчанию);
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;rx-only</B></FONT>
<DD>
инверсия только синхроимпульсов приёма (RXC/ERC). Поддерживается только адаптерами серии Tau-PCI;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;tx-only</B></FONT>
<DD>
инверсия только синхроимпульсов передачи (TXC/ETC). Поддерживается только адаптерами серии Tau-PCI;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;both/on</B></FONT>
<DD>
инверсия синхроимпульсов как приёма, так и передачи;
<DT><B>higain=on/off</B>

<DD>
Для интерфейсов E1/ИКМ-30, включение режима повышенной чувствительности приёмника. Это позволяет увеличить дальность по линии E1 до 2.5 км (по витой паре сечением 0.6 мм2);
<DT><B>monitor=on/off</B>

<DD>
Для интерфейсов E1/ИКМ-30, включение режима мониторинга (подслушивания) линии через внешние высокоомные резисторы;
<DT><B>unframed=on/off</B>

<DD>
Для интерфейсов E1/ИКМ-30, включение неструктурированного (нефреймированного) режима E1/ИКМ-30 (без структуры канальных интервалов);
<DT><B>scrambler=on/off</B>

<DD>
Для интерфейсов E1/ИКМ-30, включение скремблера в неструктурированном режиме E1/ИКМ-30;
<DT><B>cas=..</B>

<DD>
Для интерфейсов E1/ИКМ-30, задаёт режим обработки CAS (Channel Associated Signaling). Возможные значения:
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;off</B></FONT>
<DD>
нет сигнализации CAS-типа, 16-ый канальный интервал доступен для передачи данных или сигнализации CCS-типа;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;set</B></FONT>
<DD>
CAS контролируется по приёму, но замещается при передаче (нет необходимости подготавиливать CAS-данные для передачи);
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;pass</B></FONT>
<DD>
CAS контролируется по приёму и передается &quot;как есть&quot;из соответствующего логического канала;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;cross</B></FONT>
<DD>
кросс-коммутация CAS средствами аппаратного кросс-коннектора параллельно с коммутацией канальных интервалов;
<DT><B>crc4=on/off</B>

<DD>
Для интерфейсов E1/ИКМ-30, включение сверхциклов (мультифрейминга) и проверки CRC4;
<DT><B>clock=..</B>

<DD>
Для интерфейсов E1/ИКМ-30, задаёт режим синхронизации передатчика, а при работе в режиме мультиплексора всего тракта приёма-передачи. Возможные значения:
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;internal</B></FONT>
<DD>
синхронизация от внутреннего генератора;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;receive</B></FONT>
<DD>
синхронизация от приёмного тракта (по восстановленной из линии частоте);
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;rcv0</B></FONT>
<DD>
синхронизация от приёмного тракта физического интерфейса #0;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;rcv1</B></FONT>
<DD>
синхронизация от приёмного тракта физического интерфейса #1;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;rcv2</B></FONT>
<DD>
синхронизация от приёмного тракта физического интерфейса #2;
<DT><FONT SIZE="-1"><B>&nbsp;&nbsp;rcv3</B></FONT>
<DD>
синхронизация от приёмного тракта физического интерфейса #3;

</DL>
<A NAME="lbAK">&nbsp;</A>
<H2>ВЫБОР ПРОТОКОЛА</H2>

<DL COMPACT>
<DT><B>idle</B>

<DD>
Нет протокола (отключение протокольного модуля);
<DT><B>async</B>

<DD>
Асинхронный протокол без сетевой поддержки, только для адаптеров серии Sigma-ISA. При выборе протокола в <I>/dev/*</I> автоматически создаются входы для доступа к каналу;
<DT><B>sync</B>

<DD>
Поддержка интерфейса синхронного tty без непосредственной сетевой поддержки. Позволяет использовать стандартные системные средства (pppd) для организации сетевого взаимодействия. При выборе протокола в <I>/dev/*</I> автоматически создаются входы для доступа к каналу;
<DT><B>cisco</B>

<DD>
Протокол Cisco HDLC, создаёт point-to-point сетевой интерфейс;
<DT><B>rbrg</B>

<DD>
протокол удалённого моста Ethernet. С противоположной стороны канала передачи данных должен работать аналогичный модуль, либо совместимое устройство (Ethernet-мосты серий Cronyx BRDG-ETV, BRDG-ETH, конверторы серий Cronyx PCM2L, PCM2D, E1-L, мультиплексоры Cronyx E1-XL). Совместно с корреспондентом образуется полноценный мост Ethernet и создаётся Ethernet-совместимый сетевой интерфейс;
<DT><B>fr</B>

<DD>
Поддержка проколола Frame Relay (ANSI T1.167 Annex D). Для получения сетевых point-to-point интерфейсов, с помощью параметра dlci=#, необходимо добавить PVC с требуемыми номерами DLCI;
<DT><B>raw</B>

<DD>
Поддержка непосредственного обмена данными для программ пользователя. Возможен обмен как HDLC-пакетами, так и &quot;сырыми данными&quot; в прозрачном (телефонном) режиме. При выборе протокола в <I>/dev/cronyx/*</I> автоматически создаются входы для доступа к каналу;
<DT><B>packet</B>

<DD>
Организует для программ пользователя режим приёма-передачи с агрегированием мелких порций данных в пакеты HDLC, что позволяет уменьшить накладные расходы. При выборе протокола в <I>/dev/cronyx/*</I> автоматически создаются входы для доступа к каналу;
<DT><B>dahdi</B>

<DD>
Обеспечивает DAHDI-совместимый интерфейс для открытой IP-АТС Asterisk. Для сборки и загрузки протокольного модуля необходимо наличие установленного DAHDI-стека;
</DL>
<P>

<B>zaptel</B>

Обеспечивает Zaptel-совместимый интерфейс для открытой IP-АТС Asterisk. Для сборки и загрузки протокольного модуля необходимо наличие установленного Zaptel-стека;
<P>

Перед выбором протокола соответствующий протокольный модуль должен
быть загружен. При подключении протокольного модуля к логическому каналу может быть
автоматически произведена установка отдельных параметров. Так, например, почти все
протокольные модули устанавливают режим работы канала (async/hdlc/phony).
<P>
После подключения какого-либо протокола к логическому каналу часть
параметров может стать недоступной для изменения. Например, модуль
<B>cdahdi.ko</B>

запрещает изменение списка канальных интервалов, многие
протокольные модули не допускают изменение
<B>mtu</B>

и режима работы канала
(async/hdlc/phony). Поэтому, при конфигурировании с помощью утилиты
<B>sconfig</B>

рекомендуется назначать канальный протокол последним
параметром. После указания протокола необходимо указывать только
DLCI-номера (параметр dlci=#) при использовании протокола Frame Relay.

<A NAME="lbAL">&nbsp;</A>
<H2>ФАЙЛЫ</H2>

<I>/etc/cronyx.conf</I>

<BR>

<I>/sbin/cronyx.start</I>

(символьная ссылка)
<BR>

<I>/sbin/cronyx.stop</I>

(символьная ссылка)
<BR>

<I>/sbin/cronyx.restart</I>

(символьная ссылка)
<BR>

<DL COMPACT><DT><DD>
Для удобства работы предусмотрен файл конфигурации
<I>/etc/cronyx.conf</I> и обрабатывающий его sh-сценарий.
</DL>

<P>
После задания требуемой конфигурации можно загрузить драйверы и
применить установки командой <I>cronyx.start</I>. Остановить каналы и
выгрузить драйверы можно командой <I>cronyx.stop</I>.
<P>
В процессе установки sh-сценарий <B>cronyx.sh</B> (из комплекта драйверов)
будет установлен как одна из команд инициализации системы. Также этот
сценарий будет выполняться при вызове <I>cronyx.start</I> и <I>cronyx.stop</I>.
<P>
В зависимости от режима запуска <B>cronyx.sh</B> выполняет разбор параметров
конфигурации, заданных в <I>/etc/cronyx.conf</I> и транслирует их в
соответствующие вызовы утилит <I>sconfig</I>, <I>ifconfig</I> и т.д. Также
<B>cronyx.sh</B> производит загрузку (или выгрузку) модулей ядра из комплекта
драйверов.
<P>
Файл <I>/etc/cronyx.conf</I> и обрабатывающий его sh-сценарий <B>cronyx.sh</B>
предназначены для наиболее распространённых, простейших конфигураций.
В случае, если заложенных возможностей недостаточно необходимо
использовать утилиту <B>sconfig</B>.
<P>
Конфигурация в файле <I>/etc/cronyx.conf</I> задаётся в виде пар
<B>&lt;имя-объекта&gt;=&lt;значение&gt;</B>, в синтаксисе
<B><A HREF="/cgi-bin/man/man2html?1+sh">sh</A></B>(1).

Где
<B>&lt;имя-объекта&gt;</B>

должно
соответствовать имени адаптера, линейного интерфейса на адаптере или
канала. А
<B>&lt;значение&gt;</B>

задаёт конфигурацию в виде списка параметров в
синтаксисе утилиты
<B>sconfig</B>. В конфигурации каналов для некоторых
протоколов необходимо также задать локальный и/или удалённый
IP-адреса, либо локальный MAC-адрес. Номера DLCI для Frame Relay
(параметр dlci=#) следует указывать после выбора протокола, а
соответствующие локальный и удалённый IP-адреса после каждого DLCI.
<P>
<B>ВНИМАНИЕ!!!</B>

<BR>

Так как имена интерфейсов и каналов могут содержать символ `.' (точка)
и из-за ограничения синтаксиса языка
<B><A HREF="/cgi-bin/man/man2html?1+sh">sh</A></B>(1),

в файле
<I>/etc/cronyx.conf</I>

в соответствующих именах `<B>.</B>' (точка) должна быть заменена на `<B>_</B>' (подчерк).
<P>
Отредактируйте файл
<I>/etc/cronyx.conf</I>

под свои нужды, в комментариях
даны примеры типовых конфигураций. Список возможных параметров и их
значений приведены в описании утилиты
<B>sconfig</B>

(см. выше и файлы <I>readme.txt</I>).

<A NAME="lbAM">&nbsp;</A>
<H2>ПРИМЕРЫ</H2>

<DL COMPACT>
<DT><B>sconfig tau32_0 led=on clock=rcv1</B>

<DD>
Управляем адаптером Tau-PCI/32 #0, включаем светодиод и устанавливаем
синхронизацию от приёмника E1-интерфеcа #1.
<DT><B>sconfig tau32_0.e1_1 unframed=off crc4=on cas=off</B>

<DD>
Управляем E1-интерфейсом #1 на адаптере Tau-PCI/32 #0, устанавливаем
структурированный режим, сверхциклы CRC4 и отключаем CAS.
<DT><B>sconfig tau32_0.10 ts=4-8 iface=1 rbrg</B>

<DD>
Управляем каналом #10 на адаптере Tau-PCI/32 #0, назначаем канальные
интервалы на E1-интерфейсе #1, подключаем протокольный модуль
моста Ethernet.
<DT><B>sconfig cp1 ts=1-31 qlen=2 dahdi</B>

<DD>
Управляем каналом #1 на адаптере Tau-PCI/xE1, выбираем множество
канальных интервалов и подключаем DAHDI-протокол, длину очереди
передачи устанавливаем равной 2.
<DT><B>sconfig cx1 sync extclock</B>

<DD>
Настраиваем канал #1 на Sigma-ISA для соединения по протоколу PPP через DCE-устройство (HDSL или другой синхронный модем).
Не забудьте запустить службу
<B>pppd</B>

и сконфигурировать сетевой интерфейс.
<DT><B>sconfig ct0 cisco ts=1-10</B>

<DD>
Настраиваем канал #0 на Tau-ISA/E1, протокол Cisco/HDLC, канальные интервалы 1-10.
Не забудьте сконфигурировать сетевой интерфейс `ct0'.
<DT><B>sconfig ct0 cisco 256000</B>

<DD>
Настраиваем канал #0 на Tau-ISA для синхронного нуль-модемного соединения с DTE-устройством (другой компьютер или маршрутизатор), 256 кбит/с, протокол Cisco/HDLC.
Не забудьте сконфигурировать сетевой интерфейс `ct0'.
<DT><B>sconfig cx1 sync 128000 line=nrzi dpll=on</B>

<DD>
Настраиваем канал #1 на Sigma-ISA для соединения по протоколу PPP через нуль-модемный кабель без проводника синхросигнала или через модем подобный Zelax M115 (без генерации синхросигнала передачи). Синхронный режим с ФАПЧ (DPLL), 128 кбит/c, кодирование в линии NRZI.
Не забудьте сконфигурировать сетевой интерфейс `cx1'.

</DL>
<A NAME="lbAN">&nbsp;</A>
<H2>ДИАГНОСТИКА</H2>

В этом разделе приведена расшифровка аббревиатур используемых утилитой
<B>sconfig</B>

при отображении различной статистической информации. Описание опций для получения статистики смотрите выше.
<P>


<B>СТАТИСТИКА ЛОГИЧЕСКИХ КАНАЛОВ</B>

<BR>

Во время работы драйверы накапливают статистическую информацию о каждом логическом канале. Эта статистика пожжем быть получена с помощью утилиты
<B>sconfig</B>

или вызова
<B><A HREF="/cgi-bin/man/man2html?2+ioctl">ioctl</A></B>(2)

<DL COMPACT>
<DT><B>Rintr</B>

<DD>
Количество прерываний (активаций IRQ) по приёму.
<DT><B>Tintr</B>

<DD>
Количество прерываний (активаций IRQ) по передаче.
<DT><B>Mintr</B>

<DD>
Количество прерываний (активаций IRQ) по статусу модема.
<DT><B>Ibytes</B>

<DD>
Количество принятых байтов.
<DT><B>Ipkts</B>

<DD>
Количество принятых пакетов/порций данных (недоступно для асинхронного режима).
<DT><B>Ierrs</B>

<DD>
Количество ошибок приёма.
<DT><B>Obytes</B>

<DD>
Количество переданных байтов.
<DT><B>Opkts</B>

<DD>
Количество переданных пакетов/порций данных (недоступно для асинхронного режима).
<DT><B>Oerrs</B>

<DD>
Количество ошибок передачи.
</DL>
<P>


<B>СТАТИСТИКА ИНТЕРФЕЙСОВ E1/G.703</B>

<BR>

Для интерфейсов E1/ИКМ-30 (с поддержкой структурированного режима) и для интерфейсов G.703 (без поддержки структурированного режима) собирается SNMP-совместимый набор данных (смотрите RFC1406).
<DL COMPACT>
<DT><B>Unav (uas)</B>

<DD>
Недоступные секунды (unavailable seconds) - количество секунд в течении которых принимался код AIS (все единицы) или было состояние LOS (los of signal).
<DT><B>Degr (dm)</B>

<DD>
Деградирующие минуты (degraded minutes) - количество минут в течении которых уровень ошибок был выше 10e-6, не считая `недоступных' (unavailable) и `существенно ошибочных' (severely errored) секунд.
<DT><B>Bpv (bpv)</B>

<DD>
Количество зафиксированных нарушений кодирования HDB3 (code violations), не доступно при выборе кода AMI.
<DT><B>Fsyn (fse)</B>

<DD>
Количество ошибок цикловой синхронизации (frame sync errors), только для структурированного режима.
<DT><B>CRC (crce)</B>

<DD>
Количество ошибок CRC4 по приёму (CRC4 errors), только для структурированного режима с включенным контролем CRC4.
<DT><B>RCRC (rcrce)</B>

<DD>
Количество ошибок CRC4 зафиксированных удалённой стороной и индицированных в E-бите кадров E1/ИКМ-30 (E-bit counter), только для структурированного режима с включенным контролем CRC4.
<DT><B>Err (es)</B>

<DD>
Ошибочные секунды (errored seconds) - количество секунд, в течение которых были зафиксированы ошибки цикловой синхронизации, потеря цикловой синхронизации, или проскальзывания (slip events). Только для структурированного режима.
<DT><B>Lerr (les)</B>

<DD>
Секунды с ошибками в линии (line errored seconds) - количество секунд, в течение которых фиксировалось нарушение кодирования HDB3.
<DT><B>Sev (ses)</B>

<DD>
Существенно ошибочные секунды (severely errored seconds) - количество секунд, в течение которых было зафиксировано более 832 ошибок цикловой синхронизации или более 2048 случаев нарушения кодирования HDB3.
<DT><B>Bur (bes)</B>

<DD>
Секунды с множественными ошибками (bursty errored seconds) - количество секунд, в течение которых было зафиксировано более 1 ошибки цикловой синхронизации, не считая существенно ошибочных секунд (severely errored). Только для структурированного режима.
<DT><B>Oof (oofs)</B>

<DD>
Секунды без цикловой синхронизации (out of frame sync seconds) - количество секунд, в течение которых наблюдалась потеря цикловой синхронизации. Только для структурированного режима.
<DT><B>Slp (css)</B>

<DD>
Секунды контролируемых проскальзываний (controlled slip seconds) - количество секунд, в течение которых фиксировались проскальзывания (повтор или удаление кадров E1 вследствие несовпадения частот выбранного локально источника синхронизации и передатчика на удалённой стороне).
</DL>
<P>


<B>СТАТУС ИНТЕРФЕЙСОВ E1/G.703</B>

<BR>

Утилита
<B>sconfig</B>

также отображает статус интерфейсов E1/G.703, который может иметь следующие значения (могут комбинироваться):
<DL COMPACT>
<DT><B>OK</B>

<DD>
Интерфейс в нормальном состоянии, есть сигнал и цикловая синхронизация.
<DT><B>LOS</B>

<DD>
Нет сигнала. Приёмник не распознаёт несущую HDB3, либо принимает последовательно более 2048 нулей в коде AMI. В соответствии с ITU-T G.775 и ITU-T G.962.
<DT><B>AIS</B>

<DD>
Принимается код AIS (все единицы). Только для структурированного режима, в соответствии с ITU-T O.162 раздел 1.6.1.2.
<DT><B>LOF</B>

<DD>
Потеряна цикловая синхронизация. Только для структурированного режима, в соответствии с ITU-T G.706 разделы 4.1.1, 4.1.2 и 4.3.2.
<DT><B>LOMF</B>

<DD>
Потеряна сверхцикловая синхронизация CAS. Только для структурированного режима с CAS, в соответствии с ITU-T G.732 раздел 5.2.
<DT><B>CRC4E</B>

<DD>
Потеряна сверхцикловая синхронизация CRC4 или очень много ошибок CRC4. Только для структурированного режима с CRC4, в соответствии с ITU-T G.706 раздел 4.2.
<DT><B>FARLOF</B>

<DD>
Принимается сигнал удалённой аварии. Удалённая сторона сообщает об аварии по приёму с нашей стороны (потеря сигнала или цикловой синхронизации). Только для структурированного режима, в соответствии ITU-T O.162 раздел 2.1.4.
<DT><B>AIS16</B>

<DD>
В 16-ом канальном интервале принимаются все единицы. Только для структурированного режима с CAS, в соответствии ITU-T G.732 раздел 4.2.
<DT><B>FARLOMF</B>

<DD>
Принимается сигнал удалённой аварии сверхцикловой синхронизации. Удалённая сторона сообщает об аварии по приёму с нашей стороны (потеря сверхцикловой синхронизации CAS). Только для структурированного режима с CAS, в соответствии с ITU-T O.162 раздел 2.1.5.
</DL>
<P>


<A NAME="lbAO">&nbsp;</A>
<H2>ИСТОРИЯ</H2>

Эта утилита замещает устаревшие <B>cxconfig</B> и <B>ctconfig</B>,
которые использовались в прошлом в комплекте драйверов Кроникс для FreeBSD. Эти две утилиты не совместимы с <B>sconfig</B>, поэтому использующие их сценарии должны быть переписаны. Кроме этого, версии для Linux и FreeBSD не полностью совместимы между собой.
<P>
Также, версия 6.0 сильно отличается от всех более ранних.
Данное руководство может быть использовано только с версией 6.0,
все предыдущие версии КБ Кроникс в настоящее время не поддерживает.

<A NAME="lbAP">&nbsp;</A>
<H2>ОШИБКИ</H2>

Всё программное обеспечение, разрабатываемое в &quot;КБ Кроникс&quot;, проходит тщательное тестирование. Но так как оно создано людьми, последний `жучок' всегда может быть неожиданно обнаружен. Если Вы заметили какую-нибудь проблему, то попытайтесь определить условия её возникновения и отправьте на эту информацию нам по почте. Мы обязательно приложим усилия, чтобы воспроизвести ситуацию и устранить ошибку.

<A NAME="lbAQ">&nbsp;</A>
<H2>СМОТРИТЕ ТАКЖЕ</H2>

<B><A HREF="/cgi-bin/man/man2html?1+stty">stty</A></B>(1),

<B><A HREF="/cgi-bin/man/man2html?2+ioctl">ioctl</A></B>(2),

<B><A HREF="/cgi-bin/man/man2html?8+pppd">pppd</A></B>(8),

<B><A HREF="/cgi-bin/man/man2html?8+ifconfig">ifconfig</A></B>(8),

<B><A HREF="/cgi-bin/man/man2html?8+route">route</A></B>(8)


<A NAME="lbAR">&nbsp;</A>
<H2>АВТОР</H2>

Леонид Юрьев &lt;<A HREF="mailto:ly@cronyx.ru">ly@cronyx.ru</A>&gt;
<A NAME="lbAS">&nbsp;</A>
<H2>КОНТАКТЫ</H2>

E-mail: <A HREF="mailto:info@cronyx.ru">info@cronyx.ru</A>
<BR>

<A HREF="http://www.cronyx.ru">http://www.cronyx.ru</A>
<BR>

+7 (499) 946-99-90
<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">ИМЯ</A><DD>
<DT><A HREF="#lbAC">ОБЗОР</A><DD>
<DT><A HREF="#lbAD">ОПИСАНИЕ</A><DD>
<DT><A HREF="#lbAE">ОПЦИИ</A><DD>
<DT><A HREF="#lbAF">ИМЯ ОБЪЕКТА</A><DD>
<DT><A HREF="#lbAG">КОНФИГУРИРОВАНИЕ АДАПТЕРОВ</A><DD>
<DT><A HREF="#lbAH">КОНФИГУРИРОВАНИЕ ЛОГИЧЕСКИХ КАНАЛОВ</A><DD>
<DT><A HREF="#lbAI">КОНФИГУРИРОВАНИЕ ПРОТОКОЛЬНЫХ МОДУЛЕЙ</A><DD>
<DT><A HREF="#lbAJ">КОНФИГУРИРОВАНИЕ ЛИНЕЙНЫХ ИНТЕРФЕЙСОВ</A><DD>
<DT><A HREF="#lbAK">ВЫБОР ПРОТОКОЛА</A><DD>
<DT><A HREF="#lbAL">ФАЙЛЫ</A><DD>
<DT><A HREF="#lbAM">ПРИМЕРЫ</A><DD>
<DT><A HREF="#lbAN">ДИАГНОСТИКА</A><DD>
<DT><A HREF="#lbAO">ИСТОРИЯ</A><DD>
<DT><A HREF="#lbAP">ОШИБКИ</A><DD>
<DT><A HREF="#lbAQ">СМОТРИТЕ ТАКЖЕ</A><DD>
<DT><A HREF="#lbAR">АВТОР</A><DD>
<DT><A HREF="#lbAS">КОНТАКТЫ</A><DD>
</DL>
<HR>
This document was created by
<A HREF="/cgi-bin/man/man2html">man2html</A>,
using the manual pages.<BR>
Time: 13:08:19 GMT, October 29, 2009
</BODY>
</HTML>
